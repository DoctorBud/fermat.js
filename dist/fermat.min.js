// Fermat.js Mathematics Tools
// (c) 2014, Mathigon / Philipp Legner
// MIT License (https://github.com/mathigon/fermat/master/LICENSE)

!function(){function a(a){if(a.memo)return a.memo;var b={};return a.memo=function(){var c=e.call(arguments);return void 0!==b[c]?b[c]:b[c]=a.apply(this,arguments)},a.memo}function b(a){for(var b=[],c=0,d=a.length;d>c;++c)b.push(+a[c]);return b}function c(a,b){for(var c=0,d=a.length;d>c;++c)if(a[c]===b)return c;return-1}if("object"!=typeof M||!M.core)throw new Error("fermat.js requires core.js.");M.fermat=!0;var d=1e-6,e=Array.prototype.join,f=Array.prototype.push;!function(){function a(b,c,d){var e,f=[];if(1===d.length)for(e=0;e<d[0];++e)f.push(b.apply(null,c.concat([e])));else{var g=Array.prototype.slice.call(d,0),h=g.pop();for(e=0;h>e;++e)f.push(a(b,c.concat([e]),g))}return f}M.tabulate=function(b){var c=[];return f.apply(c,arguments),c.shift(),a(b,[],c)},M.list=function(a,b,c){c||(c=1);var d,e=[];if(null==b&&a>=0)for(d=0;a>d;d+=c)e.push(d);else if(null==b)for(d=0;d>a;d-=c)e.push(d);else if(b>=a)for(d=a;b>=d;d+=c)e.push(d);else for(d=a;d>=b;d-=c)e.push(d);return e},M.total=function(a){for(var b=0,c=a.length,d=0;c>d;++d)b+=+a[d]||0;return b},M.first=function(){return r[0]},M.last=function(a){return a[a.length-1]},M.min=function(a){return Math.min.apply(Math,a)},M.max=function(a){return Math.max.apply(Math,a)},M.range=function(a){return[M.min(a),M.max(a)]},M.clean=function(a){for(var b=[],c=a.length,d=0;c>d;++d)null!=a[d]&&b.push(a[d]);return b},M.unique=function(a){for(var b=[],c=a.length,d=0;c>d;++d)-1===b.indexOf(a[d])&&b.push(a[d]);return b},M.without=function(a,b){for(var c=[],d=a.length,e=0;d>e;++e)a[e]!==b&&c.push(a[e]);return c},M.chunk=function(a,b){for(var c=[],d=[],e=0,f=a.length,g=0;f>g;++g)d.push(a[g]),++e,e>=b&&(c.push(d),d=[],e=0);return d.length&&c.push(d),c},M.shuffle=function(a){a=_arraySlice.call(a,0);for(var b,c,d=a.length-1;d;--d)b=Math.floor(Math.random()*(d+1)),c=a[b],a[b]=a[d],a[d]=c;return a},M.arrayRotate=function(a,b){var c=a.length;b=(b%c+c)%c;var d=a.slice(0,b),e=a.slice(b);return f.apply(e,d),e}}(),function(){M.equals=function(a,b,c){return Math.abs(a-b)<(c||d)},M.sign=Math.sign||function(a){return a>0?1:0>a?-1:0},M.square=function(a){return a*a},M.cube=function(a){return a*a*a},M.bound=function(a,b,c){return null==c&&(c=1/0),null==b&&(b=-1/0),Math.min(c,Math.max(b,a))},M.between=function(a,b,c){return a>=b&&c>=a},M.numberFormat=function(a){a=(""+a).split(".");for(var b=a[0],c=/(\d+)(\d{3})/;c.test(b);)b=b.replace(c,"$1,$2");return b+(a.length>1?"."+a[1]:"")},M.toOrdinal=function(a){if(Math.abs(a)%100>=11&&Math.abs(a)%100<=13)return a+"th";switch(a%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd";default:return a+"th"}},M.digits=function(a){if(0===a)return[0];for(var b=[];a>0;)b.push(a%10),a=Math.floor(a/10);return b},M.decimalDigits=function(a){var c=""+Math.abs(a-Math.floor(a));return b(c.split(""))},M.decimalPlaces=function(a){var b=""+Math.abs(a);return b=b.split("."),1===b.length?0:b[1].length},M.roundTowardsZero=function(a){return 0>a?Math.ceil(a-1e-4):Math.floor(a+1e-4)},M.round=function(a,b){var c=Math.pow(10,b||0);return Math.round(a*c)/c},M.roundTo=function(a,b){return b||(b=1),Math.round(a/b)*b},M.toFixed=function(a,b){var c=a.toFixed(b);return M.equals(a,+c)?c:"~ "+c},M.toFraction=function(a,b){b=b||1e3;for(var c=[1,0],d=[0,1],e=Math.floor(a),f=a-e;d[0]<=b;){if(M.equals(c[0]/d[0],a))return[c[0],d[0]];c=[e*c[0]+c[1],c[0]],d=[e*d[0]+d[1],d[0]],e=Math.floor(1/f),f=1/f-e}return[a,1]},M.mod=function(a,b){return(a%b+a)%b},M.log=function(a,b){return M.isNumber(b)?Math.log(a)/Math.log(b):Math.log(a)},M.log10=Math.log10||function(a){return Math.log(a)/Math.log(10)},M.log2=Math.log2||function(a){return Math.log(a)/Math.log(2)},M.cosh=Math.cosh||function(a){return(Math.exp(a)+Math.exp(-a))/2},M.sinh=Math.sinh||function(a){return(Math.exp(a)-Math.exp(-a))/2}}(),function(){var a=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97];M.gcd=function b(a,c){if(arguments.length>2){var d=[].slice.call(arguments,1);return b(a,b.apply(null,d))}var e;for(a=Math.abs(a),c=Math.abs(c);c;)e=a%c,a=c,c=e;return a},M.lcm=function d(a,b){if(arguments.length>2){var c=[].slice.call(arguments,1);return d(a,d.apply(null,c))}return Math.abs(a*b)/M.gcd(a,b)},M.isPrime=function(b){if(1>=b||!M.isInt(b))return!1;if(101>b)return c(a,b)>=0;if(b%2===0)return!1;for(var d=Math.sqrt(b),e=3;d>=e;e+=2)if(b%e===0)return!1;return!0},M.isOdd=function(a){return a%2===1},M.isEven=function(a){return a%2===0},M.primeFactorization=function e(a){if(1===a)return[];if(M.isPrime(a))return[a];for(var b=Math.sqrt(a),c=2;b>=c;++c)if(a%c===0)return concatArray(e(c),e(a/c))},M.primeFactors=function(a){return M.primeFactorization(a).unique()},M.listPrimes=function(a){if(2>a)return[];for(var b=[2],c=3;a>=c;c++){var d=!1;for(var e in b)M.has(b,e)&&(d=d||0===c%b[e]);d||b.push(c)}return b}}(),function(){function b(a){if(1===a.length)return[[],a];for(var c=a.pop(),d=b(a),e=[],f=0;f<d.length;++f){var g=d[f].clone();g.push(c),e.push(d[f],g)}return e}M.factorial=a(function(a){return 0>a?0/0:0===a?1:1>=a?a:a*M.factorial(a-1)}),M.binomial=a(function(a,b){if(0===b)return 1;if(2*b>a)return M.binomial(a,a-b);for(var c=1,d=b;d>0;--d)c*=a-d+1,c/=d;return c}),M.permutations=function(a){function b(a){for(var e=0;e<a.length;e++){var f=a.splice(e,1)[0];d.push(f),0===a.length&&c.push(d.slice()),b(a),a.splice(e,0,f),d.pop()}return c}var c=[],d=[];return b(a)},M.subsets=function(a,c){var d=a.clone(),e=b(d);return c&&(e=e.filter(function(a){return a.length===c})),e},M.coinFlips=function(a){for(var b="",c=0;a>c;++c)b+=Math.random()>=.5?"H":"T";return b}}(),function(){M.random={},M.random.integer=function(a,b){return Math.floor(a+(null==b?1:b-a+1)*Math.random())},M.random.integerArray=function(a){for(var b=[],c=0;a>c;++c)b.push(c);return b.shuffle()},M.random.bernoulli=function(a){return a=Math.max(0,Math.min(1,a)),Math.random()<a?1:0},M.random.binomial=function(a,b){for(var c=0,d=0;a>d;++d)c+=M.random.bernoulli(b);return c},M.random.poisson=function(a){if(0>=a)return 0;for(var b=Math.exp(-a),c=1,d=0;c>b;++d)c*=Math.random();return d-1},M.random.uniform=function(a,b){return a+(b-a)*Math.random()},M.random.normal=function(){var a=Math.random(),b=Math.random();return Math.sqrt(-2*Math.log(a))*Math.cos(2*Math.PI*b)},M.random.exponential=function(a){return 0>=a?0:-Math.log(Math.random())/a},M.random.geometric=function(a){return 0>=a||a>0?null:Math.floor(Math.log(Math.random())/Math.log(1-a))},M.random.cauchy=function(){var a,b,c;do b=2*Math.random()-1,c=2*Math.random()-1,a=b*b+c*c;while(a>=1);return b/c},M.normalPDF=function(a,b,c){return 1/Math.sqrt(2*Math.PI*b*b)*Math.exp(-((c-a)*(c-a))/(2*b*b))}}(),function(){M.mean=M.average=function(a){return a.length?M.total(a)/a.length:0},M.median=function(a){var b=a.length;if(!b)return 0;var c=a.slice(0).sort();return len%2===1?c[Math.floor(b/2)]:(c[b/2-1]+c[b/2])/2},M.mode=function(a){for(var b,c=[],d=-1,e=0;e<a.length;e++)c[a[e]]?(c[a[e]]+=1,c[a[e]]>d&&(d=c[a[e]],b=a[e])):c[a[e]]=1;for(e=0;e<c.length;e++)if(c[e]&&e!==b&&c[e]>=d)return null;return b},M.variance=function(a){var b=a.length;if(!b)return 0;for(var c=M.mean(a),d=0,e=0;b>e;++e)d+=M.square(a[e]-c);return d/(b-1)},M.stdDev=function(a){return Math.sqrt(M.variance(a))},M.covariance=function(a,b){if(a.length!==b.length)throw new Error("Array length mismatch");for(var c=a.length,d=0,e=0;c>e;e++)d+=a[e]*b[e];return(d-a.total()*b.total()/c)/c},M.correlation=function(a,b){if(a.length!==b.length)throw new Error("Array length mismatch");var c=M.covariance(a,b),d=a.standardDev(),e=b.standardDev();return c/(d*e)},M.rSquared=function(a,b){var c=a.each(function(a,c){return M.square(a-b[c])}).sum(),d=a.each(function(b){return M.square(b-a.average())}).sum();return 1-c/d},M.linearRegression=function(a,b){var c=a.length,d=a.sum(),e=b.sum(),f=a.each(function(a,c){return a*b[c]}).sum(),g=a.each(function(a){return a*a}).sum(),h=a.average(),i=b.average(),j=(f-1/c*d*e)/(g-1/c*d*d),k=i-j*h;return function(a){return k+j*a}}}(),function(){M.Complex=function(a,b){this.re=a||0,this.im=b||0},M.extend(M.Complex.prototype,{toString:function(){return this.real?this.imaginary?this.real+" + "+this.imaginary+"i":this.real:this.imaginary+"i"},magnitude:function(){return Math.sqrt(this.re*this.re+this.im*this.im)},phase:function(){return Math.atan2(this.im,this.re)},conjugate:function(){return new M.complex(this.re,-this.im)}},!0),M.complex={},M.complex.add=function(a,b){return a instanceof M.Complex||(a=new M.Complex(a,0)),b instanceof M.Complex||(b=new M.Complex(b,0)),new M.Complex(a.re+b.re,a.im+b.im)},M.complex.sub=function(a,b){return a instanceof M.Complex||(a=new M.Complex(a,0)),b instanceof M.Complex||(b=new M.Complex(b,0)),new M.Complex(a.re-b.re,a.im-b.im)},M.complex.mult=function(a,b){a instanceof M.Complex||(a=new M.Complex(a,0)),b instanceof M.Complex||(b=new M.Complex(b,0));var c=a.re*b.re-a.im*b.im,d=a.im*b.re+a.re*b.im;return new M.complex(c,d)},M.complex.div=function(a,b){if(a instanceof M.Complex||(a=new M.Complex(a,0)),b instanceof M.Complex||(b=new M.Complex(b,0)),Math.abs(b.re)<d&&Math.abs(b.im)<d)return new M.Complex(1/0,1/0);var c=b.re*b.re+b.im*b.im,e=(a.re*b.re+a.im*b.im)/c,f=(a.im*b.re-a.re*b.im)/c;return new M.Complex(e,f)}}(),function(){var a=Object.setPrototypeOf||function(a,b){a.__proto__=b};M.Vector=function(b,c){var d;if(Array.isArray(b))d=b.slice(0);else{d=[],void 0===c&&(c=null);for(var e=0;b>e;++e)d.push(c)}return a(d,M.Vector.prototype),d},M.Vector.prototype=new Array,M.extend(M.Vector.prototype,{total:function(){return M.total(this)},average:function(){return this.total()/this.length},norm:function(){for(var a=0,b=0;b<this.length;++b)a+=M.square(this[b]);return Math.sqrt(a)},normalize:function(){for(var a=[],b=this.length,c=this.norm(),d=0;b>d;++d)a.push(a[d]/c);return M.Vector(a)},toString:function(){return"("+Array.join.call(this,", ")+")"}},!0),M.vector={},M.vector.add=function(a,b){for(var c=Math.max(a.length,b.length),d=[],e=0;c>e;++e)d.push(a[e]+b[e]);return M.Vector(d)},M.vector.subt=function(a,b){for(var c=Math.max(a.length,b.length),d=[],e=0;c>e;++e)d.push(a[e]-b[e]);return M.Vector(d)},M.vector.dot=function(a,b){for(var c=Math.max(a.length,b.length),d=0,e=0;c>e;++e)d+=(a[e]||0)*(b[e]||0);return d},M.vector.mult=function(){},M.vector.cross2D=function(a,b){return a[0]*b[1]-a[1]*b[0]},M.vector.cross=function(a,b){return M.Vector([a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]])},M.vector.angle=function(){},M.vector.project=function(){}}(),function(){M.Matrix=function(a,b,c){if(!(this instanceof M.Matrix))return new M.Matrix(a,b,c);var d=M.isArray(a);this.rows=d?a.length:a,this.columns=d?Math.max.call(Math,a.map(function(a){return a.length})):null!=b?b:a;for(var e=0;e<this.rows;++e){this[e]=[];for(var f=0;f<this.columns;++f){var g=d?a[e][f]:c;this[e][f]=null!=g?g:null}}},M.Matrix.prototype.isSquare=function(){return this.rows===this.cols},M.Matrix.prototype.row=function(a){return new M.Vector(this[a])},M.Matrix.prototype.column=function(a){for(var b=[],c=0;c<this.rows;++c)b.push(this[c][a]);return new M.Vector(b)},M.Matrix.prototype.transpose=function(){for(var a=[],b=0;b<this.columns;++b){this[b]=[];for(var c=0;c<this.rows;++c)a[b][c]=this[c][b]}return new M.Matrix(a)},M.Matrix.prototype.determinant=function(){if(!this.isSquare())throw new Error("Not a square matrix.");var a=this.rows,b=0;if(1===a)return this[0][0];if(2===a)return this[0][0]*this[1][1]-this[0][1]*this[1][0];for(var c=0;cols>c;++c){for(var d=this[0][c],e=this[0][c],f=1;rows>f;++f)e*=this[f][M.mod(c+f,a)],d*=this[f][M.mod(c-f,a)];b+=e-d}return b},M.Matrix.prototype.scalarMultiply=function(a){for(var b=[],c=0;c<this.rows;c++){b[c]=[];for(var d=0;d<this.columns;d++)b[c][d]=a*this[c][d]}return M.Matrix(b)},M.Matrix.prototype.inverse=function(){},M.matrix={},M.matrix.identity=function(a){for(var b=new M.Matrix(a,m,0),c=0;c<Math.min(a,m);++c)b[c][c]=1;return b},M.matrix.add=function(a,b){if(a.rows!==b.rows||a.cols!==b.cols)throw new Error("Matrix size mismatch");for(var c=[],d=0;d<a.length;++d){c[d]=[];for(var e=0;e<a[d].length;++e)c[d][e]=a[d][e]+b[d][e]}return M.Matrix(c)},M.matrix.rotation=function(){},M.matrix.shear=function(){},M.matrix.reflection=function(){},M.matrix.projection=function(){};var a=function(a,c){return b(c.transpose(),a)},b=function(){},c=function(){};M.matrix.mult=function(d,e){if(d instanceof M.Vector&&e instanceof M.Matrix)return a(d,e);if(d instanceof M.Matrix&&e instanceof M.Vector)return b(d,e);if(d instanceof M.Matrix&&e instanceof M.Matrix)return c(d,e);throw new Error("Can't multiply two vectors; use .dot or .cross instead.")}}(),function(){M.geo={},M.geo.Point=function(a,b){this.x=a||0,this.y=b||0},M.geo.Line=function(a,b){this.p1=a,this.p2=b},M.geo.Circle=function(a,b){this.c=null==b?new M.Point(0,0):a,this.r=null==b?1:b},M.geo.Rectangle=function(a,b,c,d){this.x=a||0,this.y=b||0,this.w=null==c?c:1,this.h=null==d?d:1},M.geo.Polygon=function(a){this.points=a},M.geo.angle=function(a,b,c){var d=Math.atan2(c.y-b.y,c.x-b.x)-Math.atan2(a.y-b.y,a.x-b.x);return 0>d&&(d+=2*Math.PI),d},M.geo.distance=function(a,b){return M.vector.diff(a,b).norm()},M.geo.isParallel=function(){},M.geo.distance=function(a,b){return Math.sqrt(M.square(a.x-b.x)+M.square(a.y-b.y))},M.geo.manhatten=function(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)},M.geo.Circle.area=function(){},M.geo.Rectangle.area=function(){};M.geo.Polygon.area=function(){},M.geo.Line.prototype.contains=function(){},M.geo.Circle.prototype.contains=function(){},M.geo.Rectangle.prototype.contains=function(){},M.geo.Polygon.prototype.contains=function(){},M.geo.reflection=function(){},M.geo.rotation=function(){},M.geo.angleBisector=function(a,b,c){var d=Math.atan2(a.y-b.y,a.x-b.x),e=Math.atan2(c.y-b.y,c.x-b.x),f=(d+e)/2;phiA>phiC&&(f+=Math.Pi);var g=b.x+Math.cos(f),h=b.y+Math.sin(f),i=new M.geo.Point(g,h);return new M.geo.Line(b,i)},M.geo.angleBisector=function(){},M.geo.perpendicular=function(){},M.geo.circumcenter=function(){},M.geo.sortVertices=function(){},M.geo.convexHull=function(){},M.geo.travellingSalesman=function(){},M.geo.projectPointOnLine=function(){},M.geo.projectLineOnLine=function(){},M.geo.intersect=function(a,b,c,d){var e=M.vector.diff(b,a),f=M.vector.diff(d,c),g=M.vector.diff(a,c),h=M.vector.cross(f,e);if(0!==h){var i=f[1]*g[0]-f[0]*g[1],j=e[1]*g[0]-e[0]*g[1],k=i/h,l=j/h;if(M.bound(k,0,1)&&M.bound(l,0,1)){var m=a[0]+k*(b[0]-a[0]),n=a[1]+l*(b[1]-a[1]);return[m,n]}}}}(),function(){var a="abcdefghijklmnopqrstuvwxyz",b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c={a:.08167,b:.01492,c:.02782,d:.04253,e:.12702,f:.02228,g:.02015,h:.06094,i:.06966,j:.00154,k:.00772,l:.04024,m:.02406,n:.06749,o:.07507,p:.01929,q:95e-5,r:.05987,s:.06327,t:.09056,u:.02758,v:.00978,w:.0236,x:.0015,y:.01974,z:74e-5};M.caesarCypher=function(c,d){for(var e="",f=0,g=c.length;g>f;f++)e+=c[f]>="a"&&c[f]<="z"?a[(a.indexOf(c[f])+d)%26]:c[f]>="A"&&c[f]<="Z"?b[(b.indexOf(c[f])+d)%26]:c[f];return e},M.vigenereCypher=function(c,d){for(var e="",f=0,g=0,h=d.toLowerCase(),i=0,j=c.length,k=h.length;j>i;i++)f=a.indexOf(h[g%k]),c[i]>="a"&&c[i]<="z"?(e+=a[(a.indexOf(c[i])+f)%26],g++):c[i]>="A"&&c[i]<="Z"?(e+=b[(b.indexOf(c[i])+f)%26],g++):e+=c[i];return e},M.letterFreqency=function(a){return c[a.toLowerCase()]},M.cipherLetterFreq=function(b){for(var c=b.toLowerCase(),d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0,f=c.length;f>e;++e)c[e]>="a"&&c[e]<="z"&&d[a.indexOf(c[e])]++;return d}}(),function(){M.bisect=function(a,b,c,d){null==b&&(b=3);var e=Math.pow(10,-b),f=Math.pow(10,b);c||(c=0);var g=a(c),h=Math.sign(g);if(0===h)return c;var i,j;if(null==d){d=.5;do d*=2,i=a(d),j=Math.sign(i);while(j===h);if(0===j)return d}for(var k=0;Math.abs(g)>e&&200>k;){var l=(c+d)/2,m=a(l),n=Math.sign(m);if(0===n)return l;n===h?(c=l,g=m):(d=l,i=m),++k}return Math.round(c*f)*e}}()}();